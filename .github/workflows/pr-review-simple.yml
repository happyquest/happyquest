name: ğŸ¤– Simple AI Code Review

on:
  pull_request:
    types: [opened, synchronize, reopened]
    branches: [main, develop]

permissions:
  contents: read
  pull-requests: write

jobs:
  simple-review:
    runs-on: ubuntu-latest
    name: Simple AI Code Review
    
    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v4
        
      - name: ğŸ’¬ Post Simple Review
        uses: actions/github-script@v7
        with:
          script: |
            const comment = `## ğŸ¤– AI Code Review - è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼

### ğŸ“‹ ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
ã“ã®Pull RequestãŒè‡ªå‹•çš„ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã•ã‚Œã¾ã—ãŸã€‚

### âœ… ç¢ºèªé …ç›®
- [ ] ã‚³ãƒ¼ãƒ‰ã®å“è³ªã¯é©åˆ‡ã§ã™ã‹ï¼Ÿ
- [ ] ãƒ†ã‚¹ãƒˆã¯è¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®å•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æ›´æ–°ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ

### ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
1. ä¸Šè¨˜ã®ç¢ºèªé …ç›®ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„
2. å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã‚’è¡Œã£ã¦ãã ã•ã„
3. ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå®Œäº†ã—ãŸã‚‰ãƒãƒ¼ã‚¸ã—ã¦ãã ã•ã„

---
*ã“ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ AI ã«ã‚ˆã£ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚*`;

            // æ—¢å­˜ã®AIãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤
            const comments = await github.rest.issues.listComments({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
            });
            
            for (const existingComment of comments.data) {
              if (existingComment.body.includes('AI Code Review')) {
                await github.rest.issues.deleteComment({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  comment_id: existingComment.id,
                });
              }
            }
            
            // æ–°ã—ã„ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              body: comment
            }); 